{#
  Header Component

  Main site header with logo and hardcoded navigation menu
  Handles active states based on current URL path
#}

{# Define base menu structure #}
{% set base_menu_items = [
  {
    title: 'Home',
    url: '/',
    current: false
  },
  {
    title: 'About',
    url: '/about',
    current: false
  },
  {
    title: 'Services',
    url: '/services',
    current: false,
    children: [
      { title: 'Web Development', url: '/services/web-development' },
      { title: 'Design', url: '/services/design' },
      { title: 'Consulting', url: '/services/consulting' }
    ]
  },
  {
    title: 'Blog',
    url: '/blog',
    current: false
  },
  {
    title: 'Contact',
    url: '/contact',
    current: false
  }
] %}

{# Process menu items to add active states based on current URL #}
{% set menu_items = [] %}
{% for item in base_menu_items %}
  {% set item_active = (current_url == item.url) or (current_url starts with item.url and item.url != '/') %}
  {% set has_active_child = false %}
  {% set processed_children = [] %}

  {# Process children if they exist #}
  {% if item.children %}
    {% for child in item.children %}
      {% set child_active = (current_url == child.url) or (current_url starts with child.url) %}
      {% if child_active %}
        {% set has_active_child = true %}
      {% endif %}
      {% set processed_children = processed_children|merge([{
        title: child.title,
        url: child.url,
        current: child_active
      }]) %}
    {% endfor %}
  {% endif %}

  {# Add processed item to menu #}
  {% set menu_items = menu_items|merge([{
    title: item.title,
    url: item.url,
    current: item_active,
    has_active_child: has_active_child,
    children: processed_children|length > 0 ? processed_children : null
  }]) %}
{% endfor %}

<header class="site-header" role="banner">
  <div class="site-header__container">
    <div class="site-header__logo">
      {% if site.has_logo %}
        <a href="{{ site.url }}" class="site-logo">
          <img src="{{ site.theme.link }}/screenshot.png" alt="{{ site.name }}">
        </a>
      {% else %}
        <a href="{{ site.url }}" class="site-name">{{ site.name }}</a>
      {% endif %}
    </div>

    {% include 'Menu/Menu.twig' with { items: menu_items } %}
  </div>
</header>
