{#
  Header Component

  Main site header with logo and navigation menu
  Handles active states based on current URL path
  Menu configuration loaded from inc/Config/menu.php
#}

{# Process menu items to add active states based on current URL #}
{% set menu_items = [] %}
{% for item in menu_config %}
  {% set item_active = (current_url == item.url) or (current_url starts with item.url and item.url != '/') %}
  {% set has_active_child = false %}
  {% set processed_children = [] %}

  {# Process children if they exist #}
  {% if item.children %}
    {% for child in item.children %}
      {% set child_active = (current_url == child.url) or (current_url starts with child.url) %}
      {% if child_active %}
        {% set has_active_child = true %}
      {% endif %}
      {% set processed_children = processed_children|merge([{
        title: child.title,
        url: child.url,
        current: child_active
      }]) %}
    {% endfor %}
  {% endif %}

  {# Add processed item to menu #}
  {% set menu_items = menu_items|merge([{
    title: item.title,
    url: item.url,
    current: item_active,
    has_active_child: has_active_child,
    children: processed_children|length > 0 ? processed_children : null
  }]) %}
{% endfor %}

<header class="site-header" role="banner">
  <div class="site-header__container">
    <div class="site-header__logo">
      {% if logo %}
        <a href="{{ site.url }}" class="site-logo">
          <img src="{{ logo.url }}" alt="{{ logo.alt }}">
        </a>
      {% else %}
        <a href="{{ site.url }}" class="site-name">{{ site.name }}</a>
      {% endif %}
    </div>

    {% include 'Menu/Menu.twig' with { items: menu_items } %}
  </div>
</header>
